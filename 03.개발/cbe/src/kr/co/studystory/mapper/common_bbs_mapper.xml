<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.studystory.common_bbs">

	<select id="selectNewAlarms" resultType="kr.co.studystory.domain.NewAlarm" parameterType="String">
		SELECT A_NUM, CATEGORY, SUBJECT, TO_CHAR(INPUT_DATE, 'yyyy-mm-dd') INPUT_DATE
		FROM ( SELECT A_NUM, CATEGORY, SUBJECT, INPUT_DATE, ROW_NUMBER() OVER( ORDER BY INPUT_DATE DESC ) R_NUM
		       FROM ALARM
		       WHERE ID=#{ id } AND READ_FLAG ='N')
		WHERE R_NUM BETWEEN 1 AND 3
	</select>
	
	<select id="selectAlarmTotal" resultType="int" parameterType="String">
		SELECT COUNT(*) cnt
		FROM alarm
		WHERE id=#{ id }
	</select>
	
	<select id="selectAlarmBbs" parameterType="kr.co.studystory.vo.AlarmBbsVO" 
		resultType="kr.co.studystory.domain.Alarm">
		SELECT A_NUM, CATEGORY, SUBJECT, TO_CHAR(INPUT_DATE, 'yyyy-mm-dd') INPUT_DATE, READ_FLAG
		FROM ( SELECT A_NUM, CATEGORY, SUBJECT, INPUT_DATE, READ_FLAG, ROW_NUMBER() OVER( ORDER BY INPUT_DATE DESC ) R_NUM
		       FROM ALARM
		       WHERE ID=#{ id } AND READ_FLAG ='N')
		WHERE R_NUM BETWEEN #{ begin } AND #{ end }
	</select>
	
	<select id="selectNoticeTotal" resultType="int">
		SELECT COUNT(*) cnt
		FROM notice
	</select>
	
	<select id="selectQuestionTotal" resultType="int">
		SELECT COUNT(*) cnt
		FROM question
		WHERE id=#{ id }
	</select>
	
	
	

</mapper>