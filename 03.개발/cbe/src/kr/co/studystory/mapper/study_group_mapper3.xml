<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.studystory.study_group3">
	<select id="selectStudyIMade" parameterType="kr.co.studystory.vo.ConditionVO" resultType="kr.co.studystory.domain.StudyIMade">
		SELECT s_num, study_name, loc, category, img, recruitment, TO_CHAR(input_date, 'yyyy-mm-dd') input_date, accept_flag, deactivation
		FROM study
		<where>
			<choose>
				<when test="loc != 'none' and category != 'none'">
					id = #{ id } AND loc = #{ loc } AND category = #{ category }
				</when>
				<when test="loc != 'none' and category == 'none'">
					id = #{ id } AND loc = #{ loc } 
				</when>
				<when test="loc == 'none' and category != 'none'">
					id = #{ id } AND category = #{ category }
				</when>
				<otherwise>
					id = #{ id }
				</otherwise>
			</choose>
		</where>
		ORDER BY input_date DESC, accept_flag desc, deactivation
	</select>
	
	  
  <select id="selectMyStudies" resultMap="myStudyResult" parameterType="String">
	select s.s_num, study_name, loc, category, s.img, recruitment, input_date, s.deactivation, u.nick
	from study s, user_table u, member m
	where u.id=#{ id } and m.id=u.id and m.s_num=s.s_num;
  </select>
  
  <select id="selectAppliedStudies" resultMap="appliedStudyResult" parameterType="String">
	select s.s_num, study_name, loc, category, s.img, recruitment, s.input_date, s.deactivation, u.nick
	from user_table u, study s, join j
	where u.id=#{ id } and j.id = u.id and j.s_num = s.s_num;
  </select>
  
</mapper>